---
id: error-handling
title: Error Handling
sidebar_label: Error Handling
hide_title: true
description: 'RTK Query > 사용법 > Error Handling: dealing with API errors'
---

&nbsp;

# Error Handling

## Overview

[fetchBaseQuery](../api/fetchBaseQuery)를 사용할 때 query나 mutation에서 오류가 발생하면 해당 hook의 error 속성에 반환됩니다. 이 경우 구성 요소가 다시 렌더링되며 원하는 경우 오류 데이터를 기반으로 적절한 UI를 표시할 수 있습니다.

### Error Display Examples

```tsx title="Query Error"
function PostsList() {
  const { data, error } = useGetPostsQuery()

  return (
    <div>
      {error.status} {JSON.stringify(error.data)}
    </div>
  )
}
```

```tsx title="Mutation Error"
function AddPost() {
  const [addPost, { error }] = useAddPostMutation()

  return (
    <div>
      {error.status} {JSON.stringify(error.data)}
    </div>
  )
}
```

:::tip
Mutation 직후 error나 success payload에 접근해야 하는 경우, `.unwrap()`을 연결 할 수 있습니다.

```ts title="Using .unwrap" no-transpile
addPost({ id: 1, name: 'Example' })
  .unwrap()
  .then((payload) => console.log('fulfilled', payload))
  .catch((error) => console.error('rejected', error))
```

:::

```tsx title="Manually selecting an error"
function PostsList() {
  const { error } = useSelector(api.endpoints.getPosts.select())

  return (
    <div>
      {error.status} {JSON.stringify(error.data)}
    </div>
  )
}
```

## Errors with a custom `baseQuery`

응답이 'data' 또는 'error'로 반환되는지의 여부는 제공된 'baseQuery'에 의해 결정됩니다.

궁극적으로 원하는 라이브러리를 통해 `baseQuery`를 구성할 수 있지만, 올바른 응답 형식을 반환하는 것이 중요합니다. 만약 아직 [`fetchBaseQuery`](../api/fetchBaseQuery) 를 사용해보지 않았다면, 한번 시도 해 보세요! Otherwise, see [Customizing Queries](./customizing-queries) for information on how to alter the returned errors.

## Handling errors at a macro level

오류를 처리할 수 있는 몇 가지 방법이 있으며, 어떤 경우에는 비동기 오류에 대한 toast notification을 표시하는 것을 원할 수 있습니다. RTK Query는 Redux 및 Redux-Toolkit을 기반으로 하기 때문에 간단하게 store에 미들웨어를 추가하여 이를 처리할 수 있습니다.

:::tip

Redux Toolkit에는 additional custom behaviors에 사용할 수 있는 [action matching utilities](../../api/matching-utilities.mdx#matching-utilities) 가 있습니다.

:::

```ts title="Error catching middleware example"
import { isRejectedWithValue } from '@reduxjs/toolkit'
import type { MiddlewareAPI, Middleware } from '@reduxjs/toolkit'
import { toast } from 'your-cool-library'

/**
 * Log a warning and show a toast!
 */
export const rtkQueryErrorLogger: Middleware = (api: MiddlewareAPI) => (
  next
) => (action) => {
  // RTK Query uses `createAsyncThunk` from redux-toolkit under the hood, so we're able to utilize these matchers!
  if (isRejectedWithValue(action)) {
    console.warn('We got a rejected action!')
    toast.warn({ title: 'Async error!', message: action.error.data.message })
  }

  return next(action)
}
```
